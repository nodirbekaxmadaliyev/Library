{% extends 'base.html' %}
{% block content %}
<h1 class="text-center flex-grow-1">Kitoblar</h1>

<form id="search-form">
    <table class="table">
        <thead>
            <tr>
                <th>Book Code</th>
                <th>Name</th>
                <th>Author</th>
                <th>Year</th>
                <th>Language</th>
                <th>Number</th>
                <td>Topshirish</td>
            </tr>
            <tr>
                <td><input type="text" name="code" class="form-control" placeholder="Code" ></td>
                <td><input  type="text" name="name" class="form-control" placeholder="Name" ></td>
                <td><input type="text" name="author" class="form-control" placeholder="Author" ></td>
                <td><input type="text" name="year" class="form-control" placeholder="Year" ></td>
                <td><input type="text" name="language" class="form-control" placeholder="Language" ></td>
                <td><input type="text" name="number" class="form-control" placeholder="Number" ></td>
                <td></td>
            </tr>
            {% for book in object_list %}
            <tr>
                <td style="text-align: center;">{{ book.book_code }}</td>
                <td><strong>{{ book.name }}</strong></td>
                <td>{{ book.authors }}</td>
                <td>{{ book.year }}</td>
                <td>{{ book.book_lang }}</td>
                <td>{{ book.number }}</td>
                <td>
                    <button id = "give_button" type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#pupilModal{{ book.pk }}" style="width: 200px;"
                    {% if book.number == 0 %}disabled{% endif %}>
                        Topshirish
                    </button>
                </td>
            </tr>

<!-- Modal har bir kitob uchun -->
   <div class="modal fade" id="pupilModal{{ book.pk }}" tabindex="-1" aria-labelledby="pupilModalLabel{{ book.pk }}" aria-hidden="true">

        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="pupilModalLabel{{ book.pk }}"><strong>{{ book.name }}</strong></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form method="post" action="{% url 'search_pupil' book.pk %}">
                        {% csrf_token %}
                           <div class="form-check" style="margin-bottom: 15px;">
                               <label for="pupil_id" class="form-label me-2">ID:</label>
                               <input class="form-control me-2" type="number" name="pupil_id" id="pupil_id" placeholder="Talaba ID" value="{{ pupil }}">
                            </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Bekor qilish</button>
                            <button type="submit" class="btn btn-success" onclick="alert('Kitob topshirildi!')">Tasdiqlash</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>


            {% endfor %}
        </thead>

    </table>
</form>
{% endblock content %}