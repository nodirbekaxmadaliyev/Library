
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Library</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body style="background-color: #F0F0F0;">
<!-- Navbar -->
<nav class="navbar bg-body-tertiary" data-bs-theme="dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="{% url 'home' %}">
      <img src="/media/images/icon.png" alt="Logo" style="width:30px; height:30px; border-radius:7px" class="d-inline-block align-text-top">
      Library
    </a>
    <div class="ms-auto" style="margin: 0 10px;">
      <a href="{% url 'profile' %}" class="link-info link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover">
        {{ user.first_name }} {{ user.last_name }}
      </a>
    </div>
    <form action="{% url 'logout' %}" method="post">
        {% csrf_token %}
        <button type="submit" class="btn btn-primary">Chiqish</button>
    </form>
  </div>
</nav>

<nav class="navbar navbar-expand-lg bg-body-tertiary">
  <div class="container-fluid">
    <a class="navbar-brand" href="{% url 'home' %}"><strong>Kitob berish</strong></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="{% url 'take_book' %}"><strong>Kitob qabul qilish</strong></a>
        </li>
        <!-- Kitoblar -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <strong>Kitoblar</strong>
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" style="color: gold;" href="{% url 'books' %}"><strong>Barchasi</strong></a></li>
            <li><a class="dropdown-item link-success link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" style="color: gold;" href="{% url 'book_add' %}"><strong>Qo'shish</strong></a></li>
          </ul>
        </li>
        <!-- Talabalar -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <strong>Talabalar</strong>
          </a>
        <ul class="dropdown-menu">
          <li><a class="dropdown-item link-primary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" style="color: gold;" href="{% url 'pupils' %}"><strong>Barchasi</strong></a></li>
          <li><a class="dropdown-item link-success link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover" style="color: gold;" href="{% url 'pupil_add' %}"><strong>Qo'shish</strong></a></li>
        </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>


<button id="scrollToTopBtn" onclick="topFunction()" style="display: none; position: fixed; bottom: 20px; right: 20px; background-color: #dc3545; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; z-index: 1000;">
    ⬆ Yuqoriga
</button>

<script>
// Talaba qidirish
    function searchStudent() {
        var studentId = document.getElementById("studentId").value;
        var resultDiv = document.getElementById("result");
        var submitButton = document.getElementById("kitobni-berish");
        var pupilIdInput = document.getElementById("pupil_id");

        if (studentId.trim() === "") {
            resultDiv.innerHTML = "<p class='text-danger'>Iltimos, talaba ID sini kiriting!</p>";
            submitButton.disabled = true;
            return;
        }

        // AJAX orqali Django backendga so‘rov yuborish
        fetch(`/search_pupil/${studentId}/`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    resultDiv.innerHTML = `<p class='text-success'>Talaba: ${data.name} (${data.id})</p>`;
                    pupilIdInput.value = data.id;
                    submitButton.disabled = false;
                } else {
                    resultDiv.innerHTML = "<p class='text-danger'>Talaba topilmadi!</p>";
                    submitButton.disabled = true;
                }
            })
            .catch(error => {
                console.error("Xatolik:", error);
                resultDiv.innerHTML = "<p class='text-danger'>Server bilan bog‘lanishda xatolik yuz berdi!</p>";
                submitButton.disabled = true;
            });
    }

// Yuqoriga chiqishga
    window.onscroll = function() { scrollFunction() };

    function scrollFunction() {
        var scrollToTopBtn = document.getElementById("scrollToTopBtn");

        // Agar 300px dan pastga skroll qilinsa, tugma ko'rinadi
        if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
            scrollToTopBtn.style.display = "block";
        } else {
            scrollToTopBtn.style.display = "none";
        }
    }

    function topFunction() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
</script>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>


{% block content %}
{% endblock content %}
</body>
</html>